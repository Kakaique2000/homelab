# Kubernetes cluster configuration
# This file contains custom settings for your Kubernetes cluster
# These override the default values from Kubespray

# Kubernetes version to install
kube_version: v1.28.6

# Network plugin (calico, flannel, weave, cilium, canal, kube-ovn, kube-router)
kube_network_plugin: calico

# Service and pod network CIDR
kube_service_addresses: 10.233.0.0/18
kube_pods_subnet: 10.233.64.0/18

# DNS configuration
dns_mode: coredns
enable_nodelocaldns: true
# Use explicit upstream DNS to avoid loop when node uses systemd-resolved (127.0.0.53)
upstream_dns_servers:
  - 8.8.8.8
  - 8.8.4.4

# Container runtime (containerd or crio)
container_manager: containerd

# Enable Kubernetes dashboard
dashboard_enabled: true

# Enable metrics server
metrics_server_enabled: true

# Enable Helm
helm_enabled: true

# Override hostname to match the inventory name (k8s-master).
# Must be a string, not boolean true â€” Kubespray v2.24.1 passes this directly
# into kubeadm-config.yaml where a bool causes "cannot unmarshal bool into string".
kube_override_hostname: k8s-master

# Download options
download_run_once: true
download_localhost: false

# Kubelet configuration
kubelet_max_pods: 110

# Enable cert-manager (useful for managing TLS certificates)
cert_manager_enabled: false

# Enable ingress-nginx controller
ingress_nginx_enabled: true
ingress_nginx_host_network: true

# Persistent volume settings
# If you have local storage or NFS, configure here
# local_path_provisioner_enabled: true

# Do not copy kubectl/kubeconfig to the local machine via Kubespray
# kubeconfig is downloaded and patched by install-k8s.sh via SCP instead
kubectl_localhost: false
kubeconfig_localhost: false
